<?php
/**
 * This template file is for the "Tags" tab in customer view and order view.
 */
?>
<?php $assignedTagNames = []; ?>
<?php foreach ($this->assignedTags as $tag) { $assignedTagNames[] = $this->escapeHtml($tag->name); } ?>
<div class="entry-edit">
    <div class="entry-edit-head">
        <h4 class="icon-head head-shipping-method">Tags</h4>
    </div>
    <fieldset>
        <div>
            <input
                type="text"
                id="tag-input"
                value="<?php echo implode(',', $assignedTagNames) ?>">
        </div>
        <strong>Click to add previously used tags:</strong>
        <div id="tag-buttons">
            <?php foreach ($this->allTags as $tag): ?>
                <button
                    type="button"
                    class="scalable"
                    data-id="<?php echo $tag->id ?>"
                    data-name="<?php echo $this->escapeHtml($tag->name) ?>"><?php echo $this->escapeHtml($tag->name) ?></button>
            <?php endforeach; ?>
        </div>
    </fieldset>
</div>
<script>
    jQuery(function() {
        Wfn.Modules.Tagger.init({
            tagUrl: '<?php echo $this->getUrl('wfn_tagger/ajax_tags/tag') ?>',
            untagUrl: '<?php echo $this->getUrl('wfn_tagger/ajax_tags/untag') ?>',
            formKey: '<?php echo Mage::getSingleton('core/session')->getFormKey() ?>',
            entityId: '<?php echo $this->entityId ?>',
            entityType: '<?php echo $this->entityType ?>'
        });
    });
</script>
